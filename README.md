# spdnet-autoencoder

## Introduction

### Goal

This project aims to implement an autoencoder designed for Symmetric Positive Definite (SPD) matrices. SPD matrices, such as covariance matrices, are commonly used to represent EEG data. These matrices have specific properties that we can leverage in our model to better represent and process them.

## Explication

The project consists of three main folders: data, models, and src.

/data: Contains the datasets generated by the program. By default, synthetic datasets are generated using synthetic_data_block_diag.py. If you create other datasets, they will be stored here. The filenames follow this naming convention:
    synthetic-dataloader + method_of_generation + train/test/val + index
    Datasets with the same generation method and index are split into training, validation, and test sets randomly.

/models: Contains the models you create. It includes an example of the first matrix from the last batch for all three splits (train, test, val), saved as image files. The data and model weights are saved in .pt and .pth formats, respectively, for future use.

/results: Contains the results when you want to have the performances between multiple models.

/src: Contains the source code of the program.


## Usage instructions 

In this section you will find information about how to use this program.

### Generating data
Synthetic data is provided by default, but you can generate new data by running:

cd src/
python3 generate_synthetic_data.py

You can modify the default generation parameters in the function defined in src/parsing.py. To see the available options and parameters, run:

python3 generate_synthetic_data.py --help

The generated data will be stored in the /data/ directory.

### Train a model
To train a model using the generated synthetic data, you can run the following example:

cd src/
python3 pipeline.py

Similar to data generation, the parameters for training can be adjusted in the src/parsing.py file. To view all available training options and parameters, run:

python3 pipeline.py --help

Please note that :
- The INDEX parameter requires the DATA to be set to "synthetic", which is the default value. Therefore, you do not need to specify this parameter unless you are working with other data types.
- The SYNTHETIC_GENERATION parameter also requires DATA to be "synthetic", which is set by default.
- The LAYERS parameter must be greater than 1 and requires the LAYERS_TYPE to be set to "regular".
- The parameters NOISE and BATCH_SIZE should not be used with DATA="synthetic", as the synthetic data is already pre-generated.
- Ensure that the index and generation method you reference with DATA="synthetic" exist in the /data folder.

The program is designed to catch errors and provide helpful feedback if an invalid configuration is used, guiding you to resolve it.

### Run a pipeline
There is a pipeline provided by default to see the influence of latent dimensions. If you want to try it, please run :

chmod +x run_pipeline.sh 
./run_pipeline.sh


### Note

Currently, the model does not work with synthetic data generated using the lambda-mu method, and there is also uncertainty regarding the correctness of this generation method. I am working to resolve this issue.